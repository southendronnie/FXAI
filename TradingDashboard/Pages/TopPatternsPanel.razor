@inject PatternService PatternService

<h3>Top Patterns</h3>

@if (TopPatterns.Count == 0)
{
    <p>No patterns available.</p>
}
else
{
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Pattern</th>
                <th>Strategy</th>
                <th>Win Rate</th>
                <th>Avg Return</th>
                <th>Net PnL</th>
                <th>Trades</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var stat in TopPatterns)
            {
                <tr>
                    <td>@stat.PatternId</td>
                    <td>@stat.StrategyId</td>
                    <td>@(stat.WinRate.ToString("P1"))</td>
                    <td>@(stat.AverageReturn.ToString("P2"))</td>
                    <td>@stat.NetPnL.ToString("F2")</td>
                    <td>@stat.TotalTrades</td>
                </tr>
            }
        </tbody>
    </table>
}

@code {
    private List<PatternStats> TopPatterns = new();

    protected override void OnInitialized()
    {
        var allStats = PatternService.GetLatestStats();
        TopPatterns = allStats
            .Where(s => s.TotalTrades >= 10)
            .OrderByDescending(s => s.NetPnL)
            .Take(10)
            .ToList();
    }
}